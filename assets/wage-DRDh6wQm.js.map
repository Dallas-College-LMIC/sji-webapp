{"version":3,"file":"wage-DRDh6wQm.js","sources":["../../src/js/wage.js","../../src/js/wage-main.js"],"sourcesContent":["import { BaseMapController } from './controllers/baseMapController.js';\n\nexport class WageMapController extends BaseMapController {\n    constructor(containerId) {\n        super(containerId, 'tti_data');\n        this.layers = [\n            { id: \"pop\", visibility: \"visible\", property: \"all_jobs_zscore_cat\", title: \"Access to All Jobs\", scoreProperty: \"all_jobs_zscore\" },\n            { id: \"job\", visibility: \"none\", property: \"living_wage_zscore_cat\", title: \"Access to Living Wage Jobs\", scoreProperty: \"living_wage_zscore\" },\n            { id: \"lab\", visibility: \"none\", property: \"not_living_wage_zscore_cat\", title: \"Access to Not Living Wage Jobs\", scoreProperty: \"Not_Living_Wage_zscore\" }\n        ];\n        this.initialize();\n    }\n\n    async initialize() {\n        await this.initializeMapWithEmptySource();\n        \n        try {\n            const geojsonData = await this.apiService.getGeojsonData();\n            console.log(\"Fetched data:\", geojsonData);\n            \n            // Add source with fetched data\n            this.mapManager.addSource(this.sourceId, geojsonData);\n\n            // Add layers and popup events\n            this.layers.forEach(layer => {\n                this.mapManager.addLayer(layer.id, this.sourceId, layer.property, layer.visibility);\n                this.mapManager.addPopupEvents(layer.id, layer.title, layer.scoreProperty);\n            });\n\n            // Setup dropdown listener\n            this.setupDropdownListener();\n\n            // Set initial export URL\n            this.updateExportLink();\n\n        } catch (error) {\n            console.error(\"Error loading data:\", error);\n            throw error; // Re-throw to be handled by error boundary\n        }\n    }\n\n    setupDropdownListener() {\n        const tti = document.getElementById(\"tti\");\n        \n        if (!tti) {\n            console.warn('Dropdown element with id \"tti\" not found');\n            return;\n        }\n        \n        const layerOrder = this.layers.map(l => l.id);\n        \n        tti.addEventListener(\"change\", () => {\n            const chosenLayer = tti.value;\n            layerOrder.forEach((layer) => {\n                this.mapManager.setLayerVisibility(layer, layer === chosenLayer ? \"visible\" : \"none\");\n            });\n            this.updateExportLink();\n        });\n    }\n\n    getLayerIds() {\n        return this.layers.map(layer => layer.id);\n    }\n}","import { WageMapController } from './wage.js';\nimport { AppInitializer } from './utils/appInitializer.js';\nimport '../styles/shared.css';\n\n// Setup global error handlers\nAppInitializer.setupGlobalErrorHandlers();\n\n// Initialize the wage map controller\nAppInitializer.initialize('mainmap', WageMapController, 'Wage Map');"],"names":["WageMapController","BaseMapController","containerId","geojsonData","layer","error","tti","layerOrder","l","chosenLayer","AppInitializer"],"mappings":"6FAEO,MAAMA,UAA0BC,CAAkB,CACrD,YAAYC,EAAa,CACrB,MAAMA,EAAa,UAAU,EAC7B,KAAK,OAAS,CACV,CAAE,GAAI,MAAO,WAAY,UAAW,SAAU,sBAAuB,MAAO,qBAAsB,cAAe,iBAAmB,EACpI,CAAE,GAAI,MAAO,WAAY,OAAQ,SAAU,yBAA0B,MAAO,6BAA8B,cAAe,oBAAsB,EAC/I,CAAE,GAAI,MAAO,WAAY,OAAQ,SAAU,6BAA8B,MAAO,iCAAkC,cAAe,wBAAwB,CAC5J,EACD,KAAK,WAAY,CACzB,CAEI,MAAM,YAAa,CACf,MAAM,KAAK,6BAA8B,EAEzC,GAAI,CACA,MAAMC,EAAc,MAAM,KAAK,WAAW,eAAgB,EAC1D,QAAQ,IAAI,gBAAiBA,CAAW,EAGxC,KAAK,WAAW,UAAU,KAAK,SAAUA,CAAW,EAGpD,KAAK,OAAO,QAAQC,GAAS,CACzB,KAAK,WAAW,SAASA,EAAM,GAAI,KAAK,SAAUA,EAAM,SAAUA,EAAM,UAAU,EAClF,KAAK,WAAW,eAAeA,EAAM,GAAIA,EAAM,MAAOA,EAAM,aAAa,CACzF,CAAa,EAGD,KAAK,sBAAuB,EAG5B,KAAK,iBAAkB,CAE1B,OAAQC,EAAO,CACZ,cAAQ,MAAM,sBAAuBA,CAAK,EACpCA,CAClB,CACA,CAEI,uBAAwB,CACpB,MAAMC,EAAM,SAAS,eAAe,KAAK,EAEzC,GAAI,CAACA,EAAK,CACN,QAAQ,KAAK,0CAA0C,EACvD,MACZ,CAEQ,MAAMC,EAAa,KAAK,OAAO,IAAIC,GAAKA,EAAE,EAAE,EAE5CF,EAAI,iBAAiB,SAAU,IAAM,CACjC,MAAMG,EAAcH,EAAI,MACxBC,EAAW,QAASH,GAAU,CAC1B,KAAK,WAAW,mBAAmBA,EAAOA,IAAUK,EAAc,UAAY,MAAM,CACpG,CAAa,EACD,KAAK,iBAAkB,CACnC,CAAS,CACT,CAEI,aAAc,CACV,OAAO,KAAK,OAAO,IAAIL,GAASA,EAAM,EAAE,CAChD,CACA,CC1DAM,EAAe,yBAA0B,EAGzCA,EAAe,WAAW,UAAWV,EAAmB,UAAU"}